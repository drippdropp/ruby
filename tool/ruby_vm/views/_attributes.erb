%# -*- mode:c; style:ruby; coding: utf-8; indent-tabs-mode: nil -*-
%# Copyright (c) 2016 Urabe, Shyouhei.  All rights reserved.
%#
%# This file is a part of  the programming language Ruby.  Permission is hereby
%# granted, to either  redistribute and/or modify this file,  provided that the
%# conditions mentioned  in the  file COPYING  are met.   Consult the  file for
%#
typedef long OFFSET;
typedef unsigned long lindex_t;
typedef VALUE GENTRY;
typedef rb_iseq_t *ISEQ;

#define CALL_ATTRIBUTE(name, insn, ...) attr_ ## name ## _ ## insn(__VA_ARGS__)

% attrs = RubyVM::Instructions.map(&:attributes).flatten.sort_by(&:name)
%
% attrs.each do |i|
<%= i.prototype_declaration %>
% end
%
% attrs.each do |i|
%   a = i.argv_maybe_unused
%   if a.empty?
%     w = ''
%   else
%     w = a.join(",\n    ")
%     w = "\n    #{w}\n" if a.size > 1
%   end

/* <%= i.pretty_name %> */
<%= i.type %>
<%= i.name %>(<%= w %>)
<%= render_c_expr i.expr -%>
% end
